---
title: "group_proj"
author: "kaki"
date: "April 18, 2020"
output: html_document
---

```{r}
# import libraries
library(car)
library(lmtest)
library(dplyr) # dataframe
library(ggplot2)
library(gmodels) # Crosstable
library(class) # knn
library(neuralnet) # ANN
library(kernlab) #SVM
library(C50) # decision tree

# read data file
housing <- read.csv("california-housing-prices.csv")
str(housing)

housing_train <- housing[1:16000,]
housing_test <- housing[16001:20640,]

```

```{r}
#clean data

housing$total_bedrooms <- ifelse(is.na(housing$total_bedrooms), mean(housing$total_bedrooms, na.rm = TRUE)/mean(housing$total_rooms, na.rm = TRUE)*housing$total_rooms, housing$total_bedrooms)

```

## linear regression

```{r}
model_lin <- lm(median_house_value ~., data = housing)
summary(model_lin)
```

## SVM

```{r}
# Data categorization
hist(housing$median_house_value)

Pricecut <- function(x) {
  if (x <100000) {
    pricecat <- "below100K"
  } else if (x >=100000 & x < 200000) {
    pricecat <- "100k-200k"
  } else if (x >=200000 & x < 300000) {
    pricecat <- "200k-300k"
  } else if (x >=300000 & x < 400000) {
    pricecat <- "300k-400k"
  } else if (x >=400000 & x < 500000) {
    pricecat <- "400k-500k"
  } else {
    pricecat <- "over500k"
  }
}

# creat new data with categorization "housingcat"
housingcat <- housing
housingcat$pricecat <- sapply(housingcat$median_house_value, FUN = Pricecut)
housingcat$pricecat <- as.factor(housingcat$pricecat)
str(housingcat)

# train & test data for "housing cat"
housingcat_train <- housingcat[1:16000,]
housingcat_test <- housingcat[16001:20640,]

# SVM1 - vanilladot - housevalue
model_svm1 <- ksvm(median_house_value ~., data = housingcat_train,
             kernel = "vanilladot")

svm1_result <- predict(model_svm1, housingcat_test)

plot(svm1_result, housingcat_test$median_house_value)
cor_svm1 <- cor(svm1_result, housingcat_test$median_house_value); cor_svm1

# SVM1_2 - vanilladot - housecategory
model_svm1_2 <- ksvm(pricecat ~., data = housingcat_train,
             kernel = "vanilladot")

svm1_2_result <- predict(model_svm1_2, housingcat_test)

aggreement1_2 <- svm1_2_result == housingcat_test$pricecat

table(svm1_2_result,housingcat_test$pricecat)
agrmt_svm1_2 <- prop.table(table(aggreement1_2)); agrmt_svm1_2


```

